name: 'Setup Windows for SpamAssassin build and test'
description: 'Setup Windows runner for SpamAssassin build and test'
runs:
  using: 'composite'
  steps:
    - name: install pyzor
      run: |
        python -m pip install "https://github.com/SpamExperts/pyzor/archive/refs/heads/master.zip"
        export PYSCRIPT=`which pyzor`
        export PYBIN=`which python`
        export PYBASE=$(dirname "$PYBIN")
        mkdir -p "$PYBASE/etc"
        echo "@python $PYSCRIPT --homedir $PYBASE/etc/pyzor %1 %2 %3 %4 %5 %6 %7 %8 %9" > $PYSCRIPT.bat
        cat "${PYSCRIPT}.bat"
      shell: bash

    - name: test pyzor install
      run: |
        pyzor ping
        pyzor check < t\data]spam]pyzor
      shell: cmd
